<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Setup GitHub</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="particles"></div>
  <div class="card">
    <h2>üîê Setup GitHub</h2>

    <input id="token" placeholder="GitHub Token">
    <input id="repo" placeholder="user/repo">
    <input id="file" placeholder="number.json">

    <button onclick="saveConfig()">Lanjut</button>
  </div>

  <!-- Cookie Popup -->
  <div id="cookie" class="cookie hidden">
    <p>Simpan data agar tidak perlu input ulang?</p>
    <button onclick="acceptCookie()">Accept</button>
    <button onclick="rejectCookie()">Reject</button>
  </div>
  <script>
document.addEventListener('DOMContentLoaded', function () {
    particleground(document.getElementById('particles'), {
      dotColor: '#999999',
      lineColor: '#777777',
      minSpeedX: 0.1,
      maxSpeedX: 0.3,
      minSpeedY: 0.1,
      maxSpeedY: 0.3,
      density: 10000,
      particleRadius: 3,
    });
  }, false);
  </script>
  <script>
  function showNotif(teks, tipe="success") {
    const notif = document.getElementById("notification");
    const ntext = document.getElementById("notification-text");

    notif.classList.remove("success", "error");
    notif.classList.add(tipe);
    
    ntext.textContent = teks;
    notif.classList.add("show");

    setTimeout(() => notif.classList.remove("show"), 3000);
}

function showLoading() {
    const el = document.getElementById("loading-bg");
    el.style.display = "flex"; // Aktifkan flex saat dipanggil
}

function hideLoading() {
    document.getElementById("loading-bg").style.display = "none";
}
async function LoadScreen() {
    showLoading();
    await new Promise(resolve => setTimeout(resolve, 1500));
    hideLoading();
    }
    
  if (localStorage.getItem('save') === 'true') {
  if (location.pathname.includes('index.html')) {
    location.href = 'dashboard.html';
  }
}

// SAVE CONFIG
async function saveConfig() {
  await LoadScreen()
  showNotif("Succes Simpen data", "success")
  window.tempConfig = {
    token: token.value,
    repo: repo.value,
    file: file.value
  };
  document.getElementById('cookie').classList.remove('hidden');
}

function acceptCookie() {
  await LoadScreen()
  showNotif("Cookiee accepted...", "success")
  Object.entries(window.tempConfig).forEach(([k,v])=>{
    localStorage.setItem(k, v);
  });
  localStorage.setItem('save','true');
  location.href = 'dashboard.html';
}

function rejectCookie() {
  await LoadScreen()
  showNotif("Cookiee not accepted...", "error")
  Object.entries(window.tempConfig).forEach(([k,v])=>{
    sessionStorage.setItem(k, v);
  });
  location.href = 'dashboard.html';
}
  </script>
</body>
</html>